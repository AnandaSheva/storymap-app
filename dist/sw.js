const CACHE_NAME="storymap-v1",urlsToCache=["/","/app.bundle.js","/main.css","/favicon.png","/images/logo.png","/images/background.jpeg"];self.addEventListener("install",(t=>{t.waitUntil(caches.open(CACHE_NAME).then((t=>(console.log("Caching app shell"),t.addAll(urlsToCache)))))})),self.addEventListener("fetch",(t=>{t.respondWith(caches.match(t.request).then((e=>{if(e)return e;const n=t.request.clone();return fetch(n).then((e=>{if(!e||200!==e.status||"basic"!==e.type)return e;const n=e.clone();return caches.open(CACHE_NAME).then((e=>{e.put(t.request,n)})),e}))})))})),self.addEventListener("push",(t=>{console.log("Push event received:",t);let e={};if(t.data)try{e=t.data.json()}catch(n){e={title:"Story berhasil dibuat",body:t.data.text()}}const n=e.title||"Story berhasil dibuat",i={body:e.options?.body||e.body||"Anda telah membuat story baru",icon:"/favicon.png",badge:"/favicon.png",tag:"story-notification",requireInteraction:!1,actions:[{action:"view",title:"Lihat Story"},{action:"close",title:"Tutup"}]};t.waitUntil(self.registration.showNotification(n,i))})),self.addEventListener("notificationclick",(t=>{t.notification.close(),"view"===t.action&&t.waitUntil(clients.openWindow("/"))}));